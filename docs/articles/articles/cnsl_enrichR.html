<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>enrichR • singleCellTK</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<script src="../../extra.js"></script><meta property="og:title" content="enrichR">
<meta property="og:description" content="singleCellTK">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">singleCellTK</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="https://www.camplab.net/sctk">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/articles/installation.html">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Documentation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Data</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../../articles/articles/import_data.html">Import Data</a>
        </li>
        <li>
          <a href="../../articles/articles/cmd_import_scRNAseq_data_as_SCE.html">Import Data for Commandline QC</a>
        </li>
        <li>
          <a href="../../articles/articles/import_genesets.html">Import Gene Sets</a>
        </li>
        <li>
          <a href="../../articles/articles/import_annotation.html">Annotation</a>
        </li>
        <li>
          <a href="../../articles/articles/export_data.html">Export Data</a>
        </li>
        <li>
          <a href="../../articles/articles/delete_data.html">Delete Data</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">QC &amp; Filtering</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../../articles/articles/cnsl_dropletqc.html">Droplet QC (R console)</a>
        </li>
        <li>
          <a href="../../articles/articles/cnsl_cellqc.html">Cell QC (R console)</a>
        </li>
        <li>
          <a href="../../articles/articles/ui_qc.html">Cell QC (Shiny UI)</a>
        </li>
        <li>
          <a href="../../articles/articles/filtering.html">Filtering</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Normalization &amp; Batch Correction</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../../articles/articles/cnsl_normalization.html">Normalization</a>
        </li>
        <li>
          <a href="../../articles/articles/batch_correction.html">Batch Correction</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Feature Selection &amp; Dimensionality Reduction</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../../articles/articles/cnsl_feature_selection.html">Feature Selection</a>
        </li>
        <li>
          <a href="../../articles/articles/cnsl_dimensionality_reduction.html">Dimensionality Reduction</a>
        </li>
        <li>
          <a href="../../articles/articles/cnsl_2d_embedding.html">2D Embedding</a>
        </li>
      </ul>
</li>
    <li>
      <a href="../../articles/articles/clustering.html">Clustering</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Differential Expression &amp; Cell Type Labeling</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../../articles/articles/differential_expression.html">Differential Expression</a>
        </li>
        <li>
          <a href="../../articles/articles/find_marker.html">Find Marker</a>
        </li>
        <li>
          <a href="../../articles/articles/cell_type_labeling.html">Cell Type Labeling</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Pathway &amp; Enrichment Analysis</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../../articles/articles/cnsl_enrichR.html">EnrichR</a>
        </li>
        <li>
          <a href="../../articles/articles/pathwayAnalysis.html">Pathway Analysis</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Curated Workflows</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../../articles/articles/cnsl_seurat_curated_workflow.html">Seurat</a>
        </li>
        <li>
          <a href="../../articles/articles/celda_curated_workflow.html">Celda</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Visualization</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../../articles/articles/visualization.html">General Visualization</a>
        </li>
        <li>
          <a href="../../articles/articles/heatmap.html">Generic Heatmap</a>
        </li>
      </ul>
</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/console_analysis_tutorial.html">Analysis of PBMC3K (R Console)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../articles/articles/cmd_qc.html">SCTK-QC</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/compbiomed/singleCellTK">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/camplab1">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="cnsl_enrichR_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>enrichR</h1>
                        <h4 class="author">Irzam Sarfraz</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/compbiomed/singleCellTK/blob/master/vignettes/articles/cnsl_enrichR.Rmd"><code>vignettes/articles/cnsl_enrichR.Rmd</code></a></small>
      <div class="hidden name"><code>cnsl_enrichR.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p><strong>EnrichR</strong> <span class="citation">[1]</span><span class="citation">[2]</span> is a GSE (Gene Set Enrichment) method that infers biological knowledge by performing enrichment of input gene sets with curated biologically relevant prior databases that represent biological functions or functional pathways. The <strong>singleCellTK</strong> toolkit offers an easy to use interface to the EnrichR method and only requires the selection of input genes and the databases against which the genes should be tested. <br></p>
<p>To view detailed instructions on how to use the method from the toolkit, please select ‘Interactive Analysis’ for using enrichR in shiny application or ‘Console Analysis’ for using this method on R console from the tabs below:</p>

<meta name="viewport" content="width=device-width, initial-scale=1">
</div>
<div id="workflow-guide" class="section level2">
<h2 class="hasAnchor">
<a href="#workflow-guide" class="anchor"></a>Workflow Guide</h2>
<div class="tab">
  <button class="tablinks" onclick="openTab(event, 'interactive')" id="ia-button">Interactive Analysis</button>
  <button class="tablinks" onclick="openTab(event, 'console')" id="console-button">Console Analysis</button>
</div>

<div id="interactive" class="tabcontent">
<p>An overall workflow guide on how to use <strong><em>EnrichR</em></strong> sub-tab is described below. <strong><em>This workflow guide assumes that the Single Cell Data has already been uploaded through the <a href="import_data.html">Import Single Cell Data</a> tab</em></strong>. <br></p>
<p><img src="ui_screenshots/pathway_analysis/enrichR_1.png"></p>
<ol style="list-style-type: decimal">
<li>Select <strong><em>Cell Annotation &amp; Pathway Analysis</em></strong> tab from the top menu. <br>
</li>
<li>Select <strong><em>EnrichR</em></strong> option from the drop-down menu. <br>
</li>
</ol>
<p><img src="ui_screenshots/pathway_analysis/enrichR_2.png"></p>
<ol start="3" style="list-style-type: decimal">
<li><p>Select if you want to upload a gene symbol file using the option <strong><em>Upload file</em></strong> or choose the <strong><em>Select Gene(s)</em></strong> option if you want to select genes from the already uploaded data. <br></p></li>
<li><p>If <strong><em>Select Gene(s)</em></strong> option is selected, you can select the genes from the available data here. Alternatively, you can upload a gene file using the options specified in <strong>(9)</strong> and <strong>(10)</strong>. <br></p></li>
<li><p>Select <strong><em>databases</em></strong> to test the input genes against. Selecting <strong><em>ALL</em></strong> will test against all available <strong><em>databases</em></strong> and may take long time to compute. <br></p></li>
<li><p>Press <strong><em>Run</em></strong> to start computation of enrichment scores. <br></p></li>
<li><p>Once <strong><em>EnrichR</em></strong> computation is complete, results can be saved to local drive by pressing the <strong><em>Download Results</em></strong> button. <br></p></li>
<li><p>Results are displayed in the table for genes that are significant (adjusted p value &lt; 0.05). <br></p></li>
</ol>
<p><img src="ui_screenshots/pathway_analysis/enrichR_3.png"></p>
<ol start="9" style="list-style-type: decimal">
<li><p>If <strong><em>Upload file</em></strong> option is selected in <strong>(3)</strong>, additional options are displayed to upload the <strong><em>gene symbols</em></strong> file. The file path can be selected here. <br></p></li>
<li><p>Once filed is selected in <strong>(9)</strong>, options to select the parameters of the input file are displayed so the input file is correctly parsed.</p></li>
</ol>
</div>
<div id="console" class="tabcontent">
<p><strong>1. Select genes and databases:</strong></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HES1"</span>, <span class="st">"PON2"</span>, <span class="st">"FBXO44"</span>, <span class="st">"DEK"</span>, <span class="st">"SOX4"</span>, <span class="st">"FBXL16"</span><span class="op">)</span>
<span class="va">databases</span> <span class="op">&lt;-</span> <span class="fu">enrichR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/enrichR/man/listEnrichrDbs.html">listEnrichrDbs</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">libraryName</span></code></pre></div>
<p><strong>2. Run ‘enrichR’ using <code>enrichRSCE</code> function:</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">enrichRes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/enrichRSCE.html">enrichRSCE</a></span><span class="op">(</span>inSCE <span class="op">=</span> <span class="va">sce</span>, glist <span class="op">=</span> <span class="va">genes</span>, db <span class="op">=</span> <span class="va">databases</span><span class="op">)</span></code></pre></div>
<p>The <code>enrichRSCE</code> function above, takes the following parameters: <br><code>inSCE</code>: input <code>SingleCellExperiment</code> object <br><code>glist</code>: vector of input gene names <br><code>db</code>: a list of databases to test <br></p>
<p><strong>3. Print results:</strong></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">enrichRes</span><span class="op">)</span></code></pre></div>
<details><summary><b>Example</b></summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="co"># Load singleCellTK &amp; pbmc3k example data</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://compbiomed.github.io/sctk_docs/">singleCellTK</a></span><span class="op">)</span>
  <span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/importExampleData.html">importExampleData</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"pbmc3k"</span><span class="op">)</span>
  <span class="co"># Select genes</span>
  <span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HES1"</span>, <span class="st">"PON2"</span>, <span class="st">"FBXO44"</span>, <span class="st">"DEK"</span>, <span class="st">"SOX4"</span>, <span class="st">"FBXL16"</span><span class="op">)</span>
  <span class="co"># Fetch databases</span>
  <span class="va">databases</span> <span class="op">&lt;-</span> <span class="fu">enrichR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/enrichR/man/listEnrichrDbs.html">listEnrichrDbs</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">libraryName</span>
  <span class="co"># Run enrichR</span>
  <span class="va">enrichRes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/enrichRSCE.html">enrichRSCE</a></span><span class="op">(</span>inSCE <span class="op">=</span> <span class="va">sce</span>, glist <span class="op">=</span> <span class="va">genes</span>, db <span class="op">=</span> <span class="va">databases</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="co"># Print the first five results</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">enrichRes</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>##                     Database_selected                               Term
## 7750       LINCS_L1000_Chem_Pert_down LJP006 MCF10A 3H-withaferin-a-3.33
## 7751       LINCS_L1000_Chem_Pert_down      LJP006 MCF10A 3H-radicicol-10
## 5530         LINCS_L1000_Chem_Pert_up    LJP006 A375 24H-KIN001-043-1.11
## 4156 Genes_Associated_with_NIH_Grants                        R01GM072915
## 7752       LINCS_L1000_Chem_Pert_down       LJP006 A549 24H-BI-2536-0.37
##      Overlap P.value Adjusted.P.value Old.P.value Old.Adjusted.P.value
## 7750    3/68 7.0e-07        0.0013233           0                    0
## 7751    3/82 1.3e-06        0.0013233           0                    0
## 5530    3/91 1.8e-06        0.0040058           0                    0
## 4156     2/8 2.1e-06        0.0002791           0                    0
## 7752   3/119 4.1e-06        0.0027163           0                    0
##      Odds.Ratio Combined.Score          Genes
## 7750   306.6000       4325.556 PON2;HES1;SOX4
## 7751   252.0886       3413.374 PON2;HES1;SOX4
## 5530   226.2045       2991.617 PON2;HES1;SOX4
## 4156  1665.6667      21777.601       DEK;SOX4
## 7752   171.3621       2127.588 PON2;HES1;SOX4
##                                         link
## 7750                        https://clue.io/
## 7751                        https://clue.io/
## 5530                        https://clue.io/
## 4156 https://grants.nih.gov/grants/oer.htm\n
## 7752                        https://clue.io/</code></pre>
</details>
</div>
<script>
document.getElementById("ia-button").click();
</script>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references csl-bib-body">
<div id="ref-Kuleshov2016" class="csl-entry">
<div class="csl-left-margin">[1] </div>
<div class="csl-right-inline">M. V. Kuleshov <em>et al.</em>, <span>“<span class="nocase">Enrichr: a comprehensive gene set enrichment analysis web server 2016 update</span>,”</span> <em>Nucleic acids research</em>, vol. 44, no. W1, pp. W90–W97, Jul. 2016, doi: <a href="https://doi.org/10.1093/nar/gkw377">10.1093/nar/gkw377</a>.</div>
</div>
<div id="ref-Chen2013" class="csl-entry">
<div class="csl-left-margin">[2] </div>
<div class="csl-right-inline">E. Y. Chen <em>et al.</em>, <span>“<span class="nocase">Enrichr: Interactive and collaborative HTML5 gene list enrichment analysis tool</span>,”</span> <em>BMC Bioinformatics</em>, vol. 14, no. 1, pp. 1–14, Apr. 2013, doi: <a href="https://doi.org/10.1186/1471-2105-14-128">10.1186/1471-2105-14-128</a>.</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Yichen Wang, Irzam Sarfraz, Rui Hong, Yusuke Koga, Salam Alabdullatif, David Jenkins, Vidya Akavoor, Xinyun Cao, Shruthi Bandyadka, Anastasia Leshchyk, Tyler Faits, Mohammed Muzamil Khan, Zhe Wang, W. Evan Johnson, Joshua David Campbell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
