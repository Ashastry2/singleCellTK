---
title: "Dimensionality Reduction"
author: "Irzam Sarfraz"
---
```{r develSetting, include=FALSE}
doEval = TRUE
```
## Introduction
`singleCellTK` offers multiple functions to compute and visualize dimensionality reduction results.
A summary of the available methods and visualization options are described below.

---

A brief summary of the two tabs is described below:

### PCA/ICA
#### Implemented Algorithms from Packages:
|reducedDims Method|Packages|Reference|
|---|---|---| 
| PCA | Scran  | [Lun ATL, McCarthy DJ, Marioni JC (2016). “A step-by-step workflow for low-level analysis of single-cell RNA-seq data with Bioconductor.” F1000Res., 5, 2122.](https://doi.org/10.12688/f1000research.9501.2) |
| PCA | Seurat | [Butler et al., Nature Biotechnology 2018](https://www.nature.com/articles/nbt.4096) & [Stuart*, Butler*, et al., Cell 2019](https://www.cell.com/cell/fulltext/S0092-8674(19)30559-8) |
| ICA | Seurat | [Butler et al., Nature Biotechnology 2018](https://www.nature.com/articles/nbt.4096) & [Stuart*, Butler*, et al., Cell 2019](https://www.cell.com/cell/fulltext/S0092-8674(19)30559-8) |

### tSNE/UMAP
#### Implemented Algorithms from Packages:
|Method|Packages|Reference|
|---|---|---| 
| tSNE | ?  | ? |
| UMAP | ?  | ? |
| tSNE | Seurat | [Butler et al., Nature Biotechnology 2018](https://www.nature.com/articles/nbt.4096) & [Stuart*, Butler*, et al., Cell 2019](https://www.cell.com/cell/fulltext/S0092-8674(19)30559-8) |
| UMAP | Seurat | [Butler et al., Nature Biotechnology 2018](https://www.nature.com/articles/nbt.4096) & [Stuart*, Butler*, et al., Cell 2019](https://www.cell.com/cell/fulltext/S0092-8674(19)30559-8) |

### Visualizations Supported
| Method | 2-Dimensional Component Plot | Elbow Plot | JackStraw Plot | Heatmap Plot |
|---|---|---|---|---|
|PCA| $\checkmark$ | $\checkmark$ | $\checkmark$ | $\checkmark$ |
|ICA| $\checkmark$ |x|x|$\checkmark$|
|tSNE| $\checkmark$ |x|x|x|
|UMAP| $\checkmark$ |x|x|x|

### General Worflow
![](ui_screenshots/dimensionality_reduction/dr_workflow.png)

---

## Workflow Guide
In general, the first step is to compute a dimensionality reduction (e.g. PCA) and then the second
step is to visualize the computed results. The usage of functions to compute and visualize 
results is described below.

1. Compute dimensionality reduction statistics using one of the available functions.
```{r, eval = FALSE}
sce <- getTSNE(inSCE = sce,
               useAssay = "normCounts",
               reducedDimName = "tsne",
               perplexity = 30,
               n_iterations = 1000)

sce <- getUMAP(inSCE = sce,
               useAssay = "normCounts",
               reducedDimName = "umap",
               nNeighbors = 30,
               nIterations = 200,
               minDist = 0.01,
               alpha = 1)

sce <- scaterPCA(inSCE = sce,
              useAssay = "scaledCounts",
              reducedDimName = "pca")

sce <- seuratPCA(inSCE = sce,
                 useAssay = "scaledCounts",
                 reducedDimName = "pca",
                 nPCs = 10)

sce <- seuratICA(inSCE = sce,
                 useAssay = "scaledCounts",
                 reducedDimName = "ica",
                 nics = 10)

sce <- seuratRunTSNE(inSCE = sce,
                     useReduction = "pca",
                     reducedDimName = "tsne",
                     dims = 10,
                     perplexity = 30)

sce <- seuratRunUMAP(inSCE = sce,
                     useReduction = "pca",
                     reducedDimName = "umap",
                     dims = 10,
                     minDist = 0.3,
                     nNeighbors = 30,
                     spread = 1)
```


2. Visualize the dimensionality reduction results using of the available visualization options.
```{r, eval=FALSE}
#To plot a simple 2D component plot for any of the 4 methods i.e. PCA, ICA, tSNE and UMAP
seuratReductionPlot(
  inSCE = sce,
  useReduction = "pca")

#To visualize a JackStraw plot
sce <- seuratComputeJackStraw(
  inSCE = sce,
  useAssay = "scaledCounts"
)

seuratJackStrawPlot(inSCE = sce)

#To visualize heatmap plot
seuratComputeHeatmap(
  inSCE = sce,
  useAssay = "scaledCounts",
  useReduction = "pca",
  dims = 10,
  nfeatures = 10)

#To visualize Elbow plot
seuratElbowPlot(
  inSCE = sce,
  reduction = "pca"
)

#Redundant functions (need appropriate use within a higher wrapper function)
#seuratHeatmapPlot()
#plotDimRed()
#plotHeatmapMulti()
```